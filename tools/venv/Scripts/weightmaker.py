stage9_transconv_weights =  [
                                [
                                    [ 
                                        [ -30, 26, 55, -95, -3, 34, -15, 63, 30, -55, 24, 103, -91, -30, 15, 83 ], 
                                        [ 30, 46, 67, -44, -44, 8, -18, 70, -11, -53, 14, 52, -52, -18, 51, 58 ], 
                                        [ -55, 77, -21, -109, 5, -35, -16, -11, -40, 32, 107, 75, 14, -29, -7, 2 ] 
                                    ], 
                                    [ 
                                        [ -29, 77, 57, -78, 28, 69, 18, 75, -46, 2, -21, 87, -124, -10, -5, 56 ], 
                                        [ 51, 104, -27, -28, -13, 44, -42, 127, -57, 17, 12, 14, -62, 5, 85, 60 ], 
                                        [ 28, 76, -38, -94, -1, -38, 4, 40, -72, 7, 33, 34, -10, -23, 60, 36 ] 
                                    ], 
                                    [ 
                                        [ 47, -5, -56, -26, 8, -8, -46, 50, -29, 24, 33, 2, 11, -2, 14, 31 ], 
                                        [ 31, 102, -53, -82, -11, 7, 47, 29, -87, 36, 11, 25, -30, -6, 7, 0 ], 
                                        [ 0, 76, 45, -71, -75, 8, -18, 12, -6, 18, -19, 0, -31, -26, 7, 89 ] 
                                    ] 
                                ], 
                                [ 
                                    [ 
                                        [ 6, -19, -53, 103, -45, -48, -95, 36, -53, 23, -35, -27, 62, -6, 34, -65 ], 
                                        [ 19, -76, -3, 89, -10, 8, -52, -3, -3, -64, 25, -65, 116, 23, -10, -55 ], 
                                        [ 37, -40, -2, 16, -20, -17, 27, -29, 27, -15, 39, 18, 56, -49, -33, -24 ] 
                                    ], 
                                    [ 
                                        [ 9, -51, -24, 89, -50, -6, -56, 14, 27, 9, 11, -69, 117, -36, -5, -113 ], 
                                        [ 34, -60, -30, 72, -100, 20, -49, -69, -73, 15, -5, -7, 127, 39, -20, -59 ], 
                                        [ 28, 20, -54, 86, -69, -5, -81, -35, -35, -47, 6, 7, 116, 24, 53, -44 ] 
                                    ], 
                                    [ 
                                        [ 23, -31, -60, 98, -21, -9, -10, 37, 6, -43, -16, -52, 56, 54, -26, 9 ], 
                                        [ -11, 20, -64, 25, -107, -61, -10, 14, -44, 16, 26, -9, 57, 32, -21, -51 ], 
                                        [ -21, 39, 6, -11, -64, -13, -48, -34, 10, -2, 48, 13, 36, -47, 38, -8 ] 
                                    ] 
                                ], 
                                [ 
                                    [ 
                                        [ -76, 14, 1, -4, -24, -8, 34, -54, 40, -4, 7, -32, -33, -17, -66, 55 ], 
                                        [ -9, -18, 4, -20, -29, 38, 89, -57, 36, -37, 48, -38, 18, 13, -71, 88 ], 
                                        [ 7, -12, 11, -36, -3, 36, 50, 2, 26, -53, 67, 31, 8, 37, -60, 64 ] 
                                    ], 
                                    [ 
                                        [ -1, 42, 57, 24, -16, 39, 89, -38, 45, -61, 66, -9, 29, -55, -68, 65 ], 
                                        [ -52, 8, 20, 10, -11, -18, 124, -32, 103, -62, 40, -42, 12, 9, -72, 106 ], 
                                        [ -17, -24, -16, -59, 1, -46, 72, -24, 52, -7, -8, -25, -12, 52, -23, 32 ] 
                                    ], 
                                    [ 
                                        [ -17, 5, -6, 19, -30, -40, 8, -44, 26, -13, 13, 27, 38, -37, -5, 49 ], 
                                        [ -9, -21, -39, -16, -31, -56, 127, 12, 34, -34, 27, -18, -11, -1, -6, 100 ], 
                                        [ -40, 69, -18, -5, -4, -53, 40, 36, 16, 0, 70, 26, -33, 11, 43, 30 ] 
                                    ] 
                                ], 
                                [ 
                                    [ 
                                        [ -21, 69, 4, -9, -29, 5, 18, 23, -95, 3, -44, -42, 12, -27, -22, 21 ], 
                                        [ -44, 9, 19, -33, -5, -29, -25, -18, -79, -41, -71, -39, 80, -39, 46, 44 ], 
                                        [ -78, 30, -16, -80, -15, -23, -19, -57, -53, -13, -11, 26, 41, 26, 38, 62 ] 
                                    ], 
                                    [ 
                                        [ -63, 51, 14, -43, 21, -87, 27, 30, -114, -14, -34, -51, 112, -44, 65, 60 ], 
                                        [ -127, 92, 22, -4, -19, -10, -22, 1, -119, -78, -77, -33, 106, 4, 75, 62 ], 
                                        [ -63, 94, 14, -40, -17, -48, 10, -10, -103, -46, -59, -26, 53, -3, 19, 19 ] 
                                    ], 
                                    [ 
                                        [ -71, 63, 15, -15, -21, -5, -21, 35, -54, -6, -61, -32, 96, 9, 42, -13 ], 
                                        [ -58, 73, -33, -2, 22, -52, 51, 6, -90, -47, 19, -23, 62, 26, 26, 60 ], 
                                        [ -29, 13, -5, -4, 51, -45, 10, -1, 3, -43, -18, 39, 45, -5, 49, 5 ] 
                                    ] 
                                ], 
                                [ 
                                    [ 
                                        [ 8, 70, 70, 77, -62, 107, 75, 10, 34, -10, 40, -36, 3, 2, -50, -16 ], 
                                        [ 43, 22, 82, 108, -9, 46, -43, 2, 26, 40, 10, -19, -98, 56, -40, -43 ],
                                        [ 21, 7, -53, 34, -68, 83, -6, 6, 26, 1, 30, -2, -46, 22, 24, -38 ] 
                                    ], 
                                    [ 
                                        [ -73, 66, 78, 87, -59, 46, -25, 6, -15, 93, 21, -11, -7, -12, -98, -6 ], 
                                        [ -21, 36, 105, 103, -65, 71, 16, -22, 18, 92, -17, -45, -16, 57, -85, -82 ], 
                                        [ -9, -10, 64, -2, 7, 88, 21, -48, -18, -15, 52, 35, -84, 59, -31, -64 ] 
                                    ], 
                                    [ 
                                        [ -36, 17, 83, -17, -7, 82, -15, -52, -14, 60, -26, 6, -71, 47, -55, -19 ], 
                                        [ -28, 36, 20, 29, -127, 126, -28, -11, 36, 55, -39, -50, 14, -18, -61, 14 ], 
                                        [ -16, -49, 28, -29, -44, 52, 64, -31, -34, 21, -31, -23, -50, 35, -10, -58 ] 
                                    ] 
                                ], 
                                [ 
                                    [ 
                                        [ 0, -53, 90, -44, -52, 18, 56, 29, 24, 4, 6, 26, 16, 91, -76, 39 ], 
                                        [ 72, 6, 7, 30, -14, 17, 28, -40, -32, 16, -3, 12, 5, 54, -46, 48 ], 
                                        [ 69, -28, 23, -52, 7, 23, 17, 18, -19, -8, 50, -20, -31, 8, 9, 7 ] 
                                    ], 
                                    [ 
                                        [ 55, -70, 97, -24, 9, 54, 84, -7, 9, -15, 16, 23, -38, 87, -31, 81 ], 
                                        [ 64, -12, 116, -38, -46, 25, 127, 17, 3, 21, 82, 28, 52, 49, -1, 79 ], 
                                        [ 8, -106, 90, -24, -14, 29, 43, 37, -4, 26, 72, 31, 26, 67, -20, 44 ] 
                                    ], 
                                    [ 
                                        [ 66, -90, 36, -14, 12, -11, 89, -11, 31, 14, 35, 46, 27, 1, 0, 65 ], 
                                        [ 29, -46, 112, -4, -11, -5, 58, 54, 50, 22, 46, 77, 48, -12, -30, 22 ], 
                                        [ 26, -98, 41, 16, 50, 41, 28, -35, -60, -24, 39, -23, 40, 22, -18, -15 ] 
                                    ] 
                                ], 
                                [ 
                                    [ 
                                        [ 56, 39, 46, -18, 87, 56, 88, -61, 21, 75, -1, -81, -2, 55, 41, 23 ], 
                                        [ 81, -28, -1, 75, 64, 113, -13, -31, -57, 107, -82, 18, -63, 25, 88, -37 ], 
                                        [ 82, -84, 53, 93, 23, 62, -9, -21, -51, 89, -108, -98, -23, 24, -1, -75 ] 
                                    ], 
                                    [ 
                                        [ 24, -47, 25, 64, 70, 59, 77, 36, -50, 101, -30, -102, -49, -38, 69, -22 ], 
                                        [ 103, -60, 42, 97, 127, 120, 66, -29, -36, 80, -46, -102, -24, -60, 64, -59 ], 
                                        [ 46, -71, 37, 21, 59, 117, -16, -65, -40, 94, -70, -6, 14, 64, 18, -3 ] 
                                    ], 
                                    [ 
                                        [ 70, -64, 97, 35, 59, 29, 3, 26, -19, 7, -41, -10, -38, -30, 61, -43 ], 
                                        [ 12, -93, 102, 80, 115, 7, 54, -20, -60, 58, -70, -95, -3, -26, 27, 45 ], 
                                        [ -5, -93, 58, 19, 17, 13, -34, 44, -55, 46, -62, -62, -16, 38, -32, 43 ] 
                                    ] 
                                ], 
                                [ 
                                    [ 
                                        [ -33, 68, 7, -7, -61, -14, 22, -24, -12, 1, 47, 36, -48, 55, 36, 20 ], 
                                        [ -1, 69, 25, -13, -78, 5, -2, -7, -45, 65, 4, 1, 5, 23, 15, 42 ], 
                                        [ -10, 46, 19, 28, -19, 94, -7, 40, -66, 11, 10, 33, 47, -16, -48, -7 ] 
                                    ], 
                                    [ 
                                        [ 39, 13, 111, 32, -49, 61, 31, 23, -16, 54, 28, 11, 18, 50, 19, 12 ], 
                                        [ 54, 72, 115, -31, -89, 127, -1, 57, -32, 20, 19, 53, 6, 61, -50, 61 ], 
                                        [ 13, 28, 5, -7, -30, 29, -19, 23, -111, 38, -13, -20, 2, 1, 6, 68 ] 
                                    ], 
                                    [ 
                                        [ -25, 58, 64, -31, -51, -14, -27, 62, -24, 65, -2, 31, -3, 10, -6, -32 ], 
                                        [ 24, 38, 94, -5, -3, 65, 58, 80, -101, -19, 22, 4, -49, 43, 18, 74 ], 
                                        [ 18, 34, 56, 15, 49, 2, 46, 35, -62, 35, -43, -53, -60, 10, 20, 81 ] 
                                    ] 
                                ] 
                            ]

stage9_transconv_biases = [ -122, 36, -27, 34, -32, -127, -35, -104 ]

stage9_conv_weights =   [ 
                            [ 
                                [ 
                                    [ 57, -52, -30, 26, -46, -46, -60, -45, 22, -3, -21, -35, -52, 4, -13, 49 ], 
                                    [ 67, -105, -3, 10, -86, -82, -51, -17, 14, 3, 62, 48, -12, -22, -2, -62 ], 
                                    [ 93, -62, 6, 34, -35, -49, 0, 1, 57, 9, 30, -83, 26, -17, -20, -47 ] 
                                ], 
                                [ 
                                    [ 65, -77, -54, 9, -18, -41, -30, 31, -15, 1, 3, -69, -54, -63, 28, 33 ], 
                                    [ 108, -111, -53, 21, -40, -114, -25, -33, 18, -20, -15, -48, 40, 31, 21, -13 ], 
                                    [ 65, -57, -59, 13, -92, -72, -33, -26, 57, -34, -23, -11, 19, -30, 13, -33 ] 
                                ], 
                                [ 
                                    [ 87, -82, -49, 17, -46, -54, 17, -14, -13, 56, -3, -13, -16, -1, 4, -41 ], 
                                    [ 104, -69, -46, 14, -56, -85, 13, -34, 26, -29, -33, 24, 23, 18, 24, 8 ], 
                                    [ 61, -77, -66, -25, -59, -127, -43, -12, 19, -17, -18, -67, 23, -17, 28, -36 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ -15, 10, 1, -5, 16, 21, 55, -24, -31, -8, 0, 11, -3, -32, 1, 34 ], 
                                    [ -54, 9, 18, -14, 58, 51, 67, -40, 11, -4, 34, 1, 12, -27, -40, -12 ], 
                                    [ -22, -8, 30, -4, 35, 55, 30, 24, -1, -38, 6, -47, 17, 39, -124, -55 ] 
                                ], 
                                [ 
                                    [ -15, 7, 23, -27, 36, 53, 41, -3, -27, 25, -6, -23, -4, -127, 35, 21 ], 
                                    [ -27, -13, 7, -22, 32, 72, 106, -29, -37, 1, 23, -6, 2, -7, 12, 0 ], 
                                    [ -38, -31, 23, -20, 22, 40, 22, 20, -42, 3, 1, -25, 9, 25, -28, -9 ] 
                                ], 
                                [ 
                                    [ -7, 24, 23, -4, 18, 47, 15, 5, -4, 40, -39, -9, 46, -23, -4, 8 ], 
                                    [ -11, -6, 40, -8, 28, 70, 64, 5, -3, 2, -52, -37, -9, -1, -10, -20 ], 
                                    [ -34, 26, 28, -1, -2, 55, 23, 6, -16, -56, -75, -35, 3, 19, 22, -21 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ 59, 18, -85, -50, -5, 32, 20, 36, -58, -30, -5, 35, 53, 9, -10, 21 ], 
                                    [ 30, 44, -60, -45, 37, 56, 38, 54, 48, -13, -39, -38, 73, 20, 0, 49 ], 
                                    [ 26, 17, -50, -17, 7, 20, -13, 52, 27, -20, -21, 45, -7, 20, 45, 43 ] 
                                ], 
                                [ 
                                    [ 27, 38, -49, -55, -41, 58, 39, 25, 4, -6, 3, 11, 48, 69, 13, 2 ],
                                    [ 61, 31, -111, -66, -37, 50, 15, 71, 58, 30, -20, 31, 12, -30, -26, 11 ], 
                                    [ 55, -9, -107, -48, 10, 4, 53, 29, 32, 0, 5, 1, -2, 22, 9, 36 ]
                                ], 
                                [ 
                                    [ 97, 77, -76, -60, 34, 53, 49, 50, 26, -25, 16, 66, 20, 55, 0, -27 ], 
                                    [ 47, 3, -95, -46, -59, 88, 33, 65, 22, -2, -6, -31, 21, -23, 20, 26 ], 
                                    [ 2, 55, -127, -35, 12, 54, 21, 18, 40, 13, -6, -4, -23, -11, -23, 41 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ -17, -41, -1, -104, -13, -16, -48, -14, 4, 0, 6, -5, 54, -6, -45, 23 ], 
                                    [ -2, 31, 29, -117, -17, 27, -35, -24, 3, -8, -7, -6, 19, 5, 6, 12 ], 
                                    [ -22, 11, 16, -107, -8, -21, -66, -10, 14, -5, 5, 15, 0, -5, -37, 43 ] 
                                ], 
                                [ 
                                    [ 3, -8, 17, -71, 3, -13, -40, -63, 6, 2, 0, -24, 22, -52, 29, 60 ], 
                                    [ 14, -8, -3, -127, 27, 23, -81, -44, 36, 5, -14, 7, 39, 20, 8, -3 ], 
                                    [ 0, -20, 37, -101, -22, 7, -45, -17, 22, 22, -7, 26, 0, -9, -22, -5 ] 
                                ], 
                                [ 
                                    [ 12, -3, 37, -67, 34, -35, -29, -43, 15, 24, 14, -36, -21, 14, 3, -43 ], 
                                    [ -10, -6, 36, -124, -3, 9, -34, -59, 33, 34, 8, 8, 8, 19, -12, 1 ], 
                                    [ -3, -26, 37, -112, -17, -21, -41, -24, -7, 9, -6, -18, 1, 1, 6, -8 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ -53, -5, -69, -31, 5, -58, 75, -58, -43, -12, 16, -2, 9, 8, -20, 7 ], 
                                    [ -72, 94, -15, -20, -24, -88, 102, -77, 18, -2, -2, -25, 45, 0, 20, -26 ], 
                                    [ -33, 40, -11, -21, -38, -90, 24, -60, 2, -20, 2, 42, 6, -5, 2, 34 ] 
                                ], 
                                [ 
                                    [ -67, 34, -53, 0, -67, -64, 64, -127, -11, 7, 6, 32, 4, -41, 28, -10 ], 
                                    [ -125, 41, -53, 15, -42, -117, 94, -106, 24, 23, -4, 34, 14, -19, -10, -11 ], 
                                    [ -84, 9, -10, -18, 4, -77, 63, -77, 11, 6, 7, -2, 3, -10, -1, -55 ] 
                                ], 
                                [ 
                                    [ -45, 98, -4, 16, 15, -86, 83, -83, 10, 5, 16, 5, -36, -1, -4, -53 ], 
                                    [ -80, 102, 3, 7, -34, -84, 89, -94, 28, 9, -12, 11, 10, -20, 0, 4 ], 
                                    [ -26, 72, -31, 10, -34, -46, 51, -98, -23, 0, -1, -30, 26, -22, -20, 10 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ -3, -79, 51, 58, -48, 50, -6, 1, -19, 19, -15, -31, -19, 39, 9, 0 ], 
                                    [ 48, -113, 106, 53, -16, 10, 0, 23, 22, 1, 12, 41, -47, 13, -9, -35 ], 
                                    [ 5, -65, 42, 69, -27, 33, 53, 11, -36, 21, -42, -39, -2, -62, -28, -22 ] 
                                ], 
                                [ 
                                    [ -18, -45, 84, 65, -19, 16, 46, 8, -1, -18, -29, -50, 1, 24, -5, 2 ], 
                                    [ 5, -99, 127, 90, -32, 54, 49, 44, -33, 2, 15, -37, 0, -28, -2, -64 ], 
                                    [ 31, -74, 98, 86, -59, 0, 69, -2, -2, 5, -38, 45, -18, -3, 30, -10 ] 
                                ], 
                                [ 
                                    [ 13, -77, 51, 48, -71, 31, 21, 18, 15, -8, -7, -31, -26, -27, 24, -50 ], 
                                    [ 2, -48, 78, 61, -28, 58, 70, 3, -35, 20, -31, 49, -7, -4, -6, -5 ], 
                                    [ 49, -76, 66, 55, -31, 14, 49, 11, -35, -6, 21, -6, -3, 37, -3, 38 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ 4, 42, 12, 68, 33, 5, -51, 6, -12, -12, 3, -3, 14, 1, -9, 13 ], 
                                    [ -26, 96, 39, 57, -11, -16, -106, 6, -26, 0, 0, 26, -6, 2, 5, -27 ], 
                                    [ 7, 51, 33, 81, 0, 22, -71, 12, -14, -12, 18, 10, 9, 14, -28, 9 ] 
                                ], 
                                [ 
                                    [ -27, 84, 23, 39, -4, 1, -69, 55, -39, 0, 9, 17, 5, 5, 8, 21 ], 
                                    [ 35, 110, 24, 94, 20, 6, -127, 0, -30, 14, -1, -28, 12, 20, -1, 22 ], 
                                    [ 10, 54, 36, 61, -5, 43, -89, 14, -13, -8, -6, 20, 2, -17, 10, 78 ] 
                                ], 
                                [ 
                                    [ 15, 65, 28, 57, 5, 19, -31, -2, -49, 7, 10, 37, 10, 17, -13, -11 ], 
                                    [ -17, 42, 50, 66, 25, -19, -80, -1, -6, -16, -5, -1, 22, 13, 20, -12 ], 
                                    [ -15, 40, 34, 48, -5, -8, -107, -8, -30, -11, -18, 13, -5, -21, -8, 20 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ 18, 3, 7, 6, 46, -24, 31, 39, -49, -10, -6, -1, 103, 15, -10, -9 ], 
                                    [ 40, -6, -20, 13, 74, -14, 39, 50, -6, -28, -76, 14, 104, 24, 27, 40 ], 
                                    [ 2, 1, -26, 14, 87, -22, -7, 8, -33, 2, -17, 18, -5, -13, 68, 36 ] 
                                ], 
                                [ 
                                    [ 16, -10, -5, 14, 110, -35, 32, 28, -10, -26, 8, 6, 26, 60, -18, 35 ], 
                                    [ -10, -27, -3, -2, 127, -71, 43, 57, -33, -12, -62, -22, -3, -14, -18, 27 ], 
                                    [ -1, 20, -36, 9, 67, -37, 55, 38, -17, -15, -4, 31, -27, 1, 27, -3 ] 
                                ], 
                                [ 
                                    [ 16, 7, -3, -2, 88, -47, 32, 11, 7, -37, 8, 26, 13, 16, 26, -42 ], 
                                    [ 3, 12, -27, 2, 81, -59, 27, 28, -20, -16, -30, 30, 14, -14, 1, 6 ], 
                                    [ 24, -11, -36, -11, 53, -30, 19, 26, -30, -3, 4, 14, -14, 5, 25, 19 ] 
                                ] 
                            ] 
                        ]

stage9_conv_biases = [ 72440, 12189, 11655, 29474, 32316, 18278, 40185, 20770 ]

stage10_conv_weights =  [ 
                            [ 
                                [ 
                                    [ -56, -65, 71, 70, 14, 87, 80, -127 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ -127, 90, -37, 13, 33, -75, 36, -98 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ -88, -71, -63, -87, 64, -127, 102, -13 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ -52, -38, -106, -62, -36, 7, -127, -82 ] 
                                ]
                            ],
                            [ 
                                [ 
                                    [ -12, -39, -57, 33, -16, -34, 55, -127 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ -71, 77, -49, -127, -17, 65, 63, 85 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ 3, -20, -56, -127, -66, 79, -58, -91 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ -58, -127, -84, -79, -124, 43, 127, -78 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ -81, -127, -84, -54, -100, -90, -28, -31 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ -127, -47, 107, 33, -49, -103, 37, 93 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ 18, -72, -68, -56, -127, -39, -96, -111 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ 68, -10, -15, -23, 100, -45, -127, -29 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ 71, -62, 103, 42, -127, -58, -80, -125 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ 53, -38, -73, -127, -112, 62, -49, -75 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ -9, 109, -22, 73, -32, 84, -127, -123 ] 
                                ] 
                            ], 
                            [ 
                                [ 
                                    [ 127, -21, -74, -64, -66, -41, 2, -28 ]
                                ] 
                            ]
                        ]

stage10_conv_biases = [ 3664, -1108, 2405, -2825, -990, 299, -696, -1140, -2920, -1467, -1636, 1519, 47, -933, 1805, -1337, -107 ]


def pack(hex1, hex2, hex3, hex4):
    return (hex1 & 0xFF) << 24 | (hex2 & 0xFF) << 16 | (hex3 & 0xFF) << 8 | (hex4 & 0xFF)

weightslist = []

# [outlayer][row][col][inputlayer] 

pack_patterns = [
    [(1,0,0), (0,2,0), (0,1,0), (0,0,0)],
    [(2,1,0), (2,0,0), (1,2,0), (1,1,0)],
    [(0,2,1), (0,1,1), (0,0,1), (2,2,0)],
    [(2,0,1), (1,2,1), (1,1,1), (1,0,1)],
    [(0,1,2), (0,0,2), (2,2,1), (2,1,1)],
    [(1,2,2), (1,1,2), (1,0,2), (0,2,2)],
    [(0,0,3), (2,2,2), (2,1,2), (2,0,2)],
    [(1,1,3), (1,0,3), (0,2,3), (0,1,3)],
    [(2,2,3), (2,1,3), (2,0,3), (1,2,3)],
]

for i in range(0, 16, 4):
    for o in range(8):
        for pattern in pack_patterns:
            weightslist.append(pack(*[stage9_transconv_weights[o][y][x][i+offset] for (y,x,offset) in pattern]))

for o in range(0,8):
    for i in range (0, 16, 4):
        for pattern in pack_patterns:
            weightslist.append(pack(*[stage9_conv_weights[o][y][x][i+offset] for (y,x,offset) in pattern]))

for o in range(0,16):
    for i in range (0,8,4):
        for pattern in pack_patterns:
            weightslist.append(pack(*[stage10_conv_weights[o][0][0][i+offset] if x==1 or y==1 else 0 for (y,x,offset) in pattern]))

for bias in stage9_transconv_biases:
    weightslist.append(bias & 0xFF)

k = 0
for i in range(4):
    for j in range(7):
        if j==0: 
            weightslist.append(stage9_conv_biases[k] & 0xFFFFFFFF)
            weightslist.append(stage9_conv_biases[k+1] & 0xFFFFFFFF)
            k=k+2
        else:
            weightslist.append(0)

k = 0
for i in range(4):
    for j in range(5):
        if j==0: 
            weightslist.append(stage10_conv_biases[k] & 0xFFFFFFFF)
            weightslist.append(stage10_conv_biases[k+1] & 0xFFFFFFFF)
            weightslist.append(stage10_conv_biases[k+2] & 0xFFFFFFFF)
            weightslist.append(stage10_conv_biases[k+3] & 0xFFFFFFFF)
            k=k+4
        else:
            weightslist.append(0)

stage9_transconv_scale = 0.016558224335312843 
stage9_transconv_zp = 15
stage9_conv_scale = 0.02279088646173477  
stage9_conv_zp = 128
stage10_conv_scale = 0.07842429727315903  
stage10_conv_zp = -5

weightslist.append((int(round(stage9_transconv_scale*(1<<16))) & 0xFFFF) << 16 | (stage9_transconv_zp & 0xFF))
weightslist.append((int(round(stage9_conv_scale*(1<<16))) & 0xFFFF) << 16 | (stage9_conv_zp & 0xFF))
weightslist.append((int(round(stage10_conv_scale*(1<<16))) & 0xFFFF) << 16 | (stage10_conv_zp & 0xFF))

with open("weightdata.mem", "w") as f:
    for w in weightslist:
        f.write(f"{w:08x}\n")